(this["webpackJsonpcv-visualizer"]=this["webpackJsonpcv-visualizer"]||[]).push([[0],{155:function(e,t,a){},187:function(e,t,a){},188:function(e,t,a){},189:function(e,t,a){},191:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(54),o=a.n(c),i=(a(155),a(67)),l=a(27),s=a(200),u=a(114),d=a(8),j=function(){return Object(d.jsxs)(u.a,{bg:"dark",variant:"dark",children:[Object(d.jsx)(u.a.Brand,{as:i.b,to:"/",children:"Epic home page"}),Object(d.jsx)(s.a.Link,{as:i.b,to:"/map",children:"Map"}),Object(d.jsx)(s.a.Link,{as:i.b,to:"/timeline",children:"Timeline"}),Object(d.jsx)(s.a.Link,{children:"Multi app page"})]})},p=a(46),b=function(e){return{type:"MAP_SIZE_CHANGED",payload:e}},O=a(63),h=a(196),m=a(125),v=a(126),f=a(197),g=a(100),y=a(11),x=a(127),w=a(135),E=a(132),A=a(84),L=a(133),k=a(98),S=a(105),C=a(113),_=a(134),I=function(){function e(t){Object(m.a)(this,e),this.map=void 0;var a=new S.a({source:new C.a});a.setProperties({id:"default"}),this.map=new f.a({controls:Object(g.a)(),target:t,layers:[new L.a({source:new E.a})],view:new _.a({center:Object(y.d)([21,61]),zoom:10})}),this.map.addLayer(a),this.map.on("moveend",(function(e){t.dispatchEvent(new CustomEvent("viewchange",{detail:{zoom:e.map.getView().getZoom(),location:{latitude:Object(y.l)(e.map.getView().getCenter())[1],longitude:Object(y.l)(e.map.getView().getCenter())[0]}}}))})),this.map.on("click",(function(e){var a,n,r=null===(a=e.map)||void 0===a||null===(n=a.getFeaturesAtPixel(e.pixel)[0])||void 0===n?void 0:n.getId();t.dispatchEvent(new CustomEvent("click-map",{detail:{location:Object(y.l)(e.coordinate),featureId:r}}))}))}return Object(v.a)(e,[{key:"addSVG",value:function(e,t,a,n,r){if(this.getAllFeatures().some((function(e){return e.getId()===a})))console.error("Already added feature: ".concat(a));else if(this.getAllVectorLayerIds().includes(r)){var c=new x.a({geometry:new k.a(Object(y.d)([e,t]))});c.setId(a),c.setStyle((function(e,t){return t=(t=t>50?50:t)<.25?.25:t,new A.b({image:new w.a({src:n,scale:Math.pow(t/5,-1/4)})})})),this.getVectorLayer(r).getSource().addFeature(c)}else console.error("No layer: ".concat(r))}},{key:"addVectorLayer",value:function(e){if(this.getAllVectorLayerIds().includes(e))console.error("Already added layer: ".concat(e));else{var t=new S.a({source:new C.a});t.setProperties({id:e}),this.map.addLayer(t)}}},{key:"getAllFeatures",value:function(){var e=this.getAllVectorLayers().map((function(e){return e.getSource().getFeatures()}));return Array.prototype.concat.apply([],e)}},{key:"getAllVectorLayerIds",value:function(){return this.getAllVectorLayers().map((function(e){return e.getProperties().id}))}},{key:"getAllVectorLayers",value:function(){return this.map.getLayers().getArray().filter((function(e){return e instanceof S.a}))}},{key:"getVectorLayer",value:function(e){return this.getAllVectorLayers().find((function(t){return t.getProperties().id===e}))}},{key:"removeAllSVGs",value:function(){var e=this;this.getAllFeatures().forEach((function(t){return e.removeSVG(t.getId())}))}},{key:"removeLayer",value:function(e){this.getAllVectorLayerIds().includes(e)?this.map.removeLayer(this.getVectorLayer(e)):console.error("No layer on map: ".concat(e))}},{key:"removeSVG",value:function(e){var t=this.getAllVectorLayers().find((function(t){return t.getSource().getFeatures().some((function(t){return t.getId()===e}))}));t.getSource().removeFeature(t.getSource().getFeatureById(e))}},{key:"setCenterView",value:function(e,t){this.map.setView(new _.a({center:Object(y.d)([e,t]),zoom:this.map.getView().getZoom()}))}},{key:"setZoomLevel",value:function(e){this.map.setView(new _.a({zoom:e,center:this.map.getView().getCenter()}))}},{key:"updateSize",value:function(){this.map.updateSize()}}]),e}(),V=a(69),D=a.n(V),T=a(82),M=a(128),z=a.n(M),G=function(){var e=Object(T.a)(D.a.mark((function e(t){var a,n,r,c;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://maps.googleapis.com/maps/api/geocode/json?address=[ADDRESS]&components=country:FI&key=".concat("AIzaSyDgzSBuSrbgTnf7_diITx0NfJWBvTA5VuU"),e.next=3,z.a.get(n.replace("[ADDRESS]",t));case 3:return r=e.sent,c=null===r||void 0===r||null===(a=r.data)||void 0===a?void 0:a.results.filter((function(e){return e.types.includes("street_address")})),e.abrupt("return",c.map((function(e){var t,a=null===e||void 0===e||null===(t=e.geometry)||void 0===t?void 0:t.location;return{location:{latitude:a.lat,longitude:a.lng},longName:e.formatted_address}})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=a(198),R=a(199),W=a(195),F=a(130),P=function(){var e=Object(n.useState)(""),t=Object(O.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(""),o=Object(O.a)(c,2),i=o[0],l=o[1],s=Object(n.useState)("tiny"),u=Object(O.a)(s,2),j=u[0],b=u[1],m=Object(n.useState)(""),v=Object(O.a)(m,2),f=v[0],g=v[1],y=Object(n.useState)(""),x=Object(O.a)(y,2),w=x[0],E=x[1],A=Object(n.useState)(null),L=Object(O.a)(A,2),k=L[0],S=L[1],C=Object(p.b)(),_=function(){var e=Object(T.a)(D.a.mark((function e(t){var n,r,c;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),k&&a.length){e.next=3;break}return e.abrupt("return");case 3:try{c={location:{latitude:null===(n=k.location)||void 0===n?void 0:n.latitude,longitude:null===(r=k.location)||void 0===r?void 0:r.longitude},name:a,description:f,size:j,id:(9999997*Math.random()+3).toString()},C({payload:c,type:"ADD_WORKPLACE"}),C({type:"TOGGLE_WORK_MODAL"})}catch(o){console.log(o)}case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(T.a)(D.a.mark((function e(t){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.target.value.length<4)){e.next=3;break}return E("Minimum 4 characters"),e.abrupt("return");case 3:return E(""),e.next=6,G(t.target.value);case 6:(a=e.sent).length?1===a.length?(l(a[0].longName),S(a[0])):(E("Too many results"),S(null)):(E("No street address"),S(null));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)(N.a,{show:!0,animation:!1,children:[Object(d.jsx)(N.a.Header,{closeButton:!0,onClick:function(){return C({type:"TOGGLE_WORK_MODAL"})},children:Object(d.jsx)(N.a.Title,{children:"New workplace"})}),Object(d.jsx)(N.a.Body,{children:Object(d.jsxs)(R.a,{children:[Object(d.jsxs)(W.a,{className:"mb-3",children:[Object(d.jsxs)(R.a.Group,{as:F.a,controlId:"formName",children:[Object(d.jsx)(R.a.Label,{children:"Name"}),Object(d.jsx)(R.a.Control,{type:"name",onChange:function(e){return r(e.target.value)}})]}),Object(d.jsxs)(R.a.Group,{as:F.a,controlId:"formEmployees",children:[Object(d.jsx)(R.a.Label,{children:"Employees"}),Object(d.jsxs)(R.a.Control,{as:"select",onChange:function(e){return b(e.target.value)},children:[Object(d.jsx)("option",{value:"tiny",children:"under 5"}),Object(d.jsx)("option",{value:"small",children:"6 - 25"}),Object(d.jsx)("option",{value:"medium-minus",children:"26 - 100"}),Object(d.jsx)("option",{value:"medium",children:"101 - 300"}),Object(d.jsx)("option",{value:"medium-plus",children:"301 - 1000"}),Object(d.jsx)("option",{value:"large",children:"1001 - 3000"}),Object(d.jsx)("option",{value:"very large",children:"over 3000"})]})]})]}),Object(d.jsxs)(R.a.Group,{className:"mb-3",controlId:"formGridAddress1",children:[Object(d.jsx)(R.a.Label,{children:"Address"}),Object(d.jsx)(R.a.Control,{value:i,onChange:function(e){return l(e.target.value)},onBlur:I}),Object(d.jsx)(R.a.Text,{muted:!0,children:w})]}),Object(d.jsxs)(R.a.Group,{className:"mb-3",controlId:"formGridAddress2",children:[Object(d.jsx)(R.a.Label,{children:"Description"}),Object(d.jsx)(R.a.Control,{as:"textarea",onChange:function(e){return g(e.target.value)}})]}),Object(d.jsx)(h.a,{onClick:_,variant:"primary",type:"submit",children:"Save"})]})})]})},K=a.p+"static/media/workplace.644bf0a4.svg",B=(a(186),a(187),function(){var e=Object(n.useState)(),t=Object(O.a)(e,2),a=t[0],r=t[1],c=Object(n.useRef)(null),o=Object(p.b)(),i=Object(p.c)((function(e){return e.map.zoom})),l=Object(p.c)((function(e){return e.map.location})),s=Object(p.c)((function(e){return e.map.sizeChanged})),u=Object(p.c)((function(e){return e.modal.showWorkplaceModal})),j=Object(p.c)((function(e){return e.map.workplaces}));Object(n.useEffect)((function(){null===a||void 0===a||a.setZoomLevel(i),null===a||void 0===a||a.setCenterView(l.longitude,l.latitude),s&&(null===a||void 0===a||a.updateSize())}),[a,l,s,i]),Object(n.useEffect)((function(){var e,t;r(new I(c.current)),null===(e=c.current)||void 0===e||e.addEventListener("viewchange",(function(e){var t=e.detail,a=t.location,n=t.zoom;o(function(e,t){return{payload:{location:e,zoom:t},type:"SET_MAPVIEW"}}(a,n))})),null===(t=c.current)||void 0===t||t.addEventListener("click-map",(function(e){o({payload:e.detail.location,type:"LAST_CLICKED_COORDS"}),o({payload:e.detail.featureId,type:"LAST_CLICKED_FEATURE_ID"})}))}),[o]),Object(n.useEffect)((function(){null===a||void 0===a||a.removeAllSVGs(),j.forEach((function(e){var t=e.location,n=t.latitude,r=t.longitude;null===a||void 0===a||a.addSVG(r,n,e.id,K,"default")}))}),[j,a]);return Object(d.jsxs)("div",{id:"map-container",children:[Object(d.jsx)("div",{className:"tool-bar",children:Object(d.jsx)(h.a,{variant:"primary",onClick:function(){o({type:"TOGGLE_WORK_MODAL"})},children:"Add Place"})}),Object(d.jsx)("div",{id:"map",ref:c}),u&&Object(d.jsx)(P,{})]})}),J=a(112),Z=function(){return Object(d.jsx)("div",{style:{border:"1px solid"},children:Object(d.jsx)("h1",{children:"Timeline coming...."})})},H=(a(188),function(){var e=Object(p.b)();return Object(n.useEffect)((function(){Object(J.a)(["#split-row-top","#split-row-bottom"],{direction:"vertical",onDrag:function(){return e(b(!0))},onDragEnd:function(){return e(b(!0))}}),Object(J.a)(["#split-col-left","#split-col-right"],{direction:"horizontal"}),e(b(!0))}),[e]),Object(d.jsx)("div",{className:"home-page",children:Object(d.jsxs)("div",{className:"main-split",children:[Object(d.jsx)("div",{id:"split-row-top",children:Object(d.jsx)(B,{})}),Object(d.jsx)("div",{id:"split-row-bottom",children:Object(d.jsxs)("div",{className:"split-nested",children:[Object(d.jsx)("div",{id:"split-col-left",children:Object(d.jsxs)("div",{style:{border:"1px solid"},children:["T\xe4h\xe4n tulee viewer ",Object(d.jsx)("br",{})," asd"]})}),Object(d.jsx)("div",{id:"split-col-right",children:Object(d.jsx)(Z,{})})]})})]})})}),U=(a(189),a(190),function(){return Object(d.jsx)("div",{id:"App",children:Object(d.jsxs)(i.a,{children:[Object(d.jsx)("div",{className:"header",children:Object(d.jsx)(j,{})}),Object(d.jsx)("div",{className:"content",children:Object(d.jsxs)(l.c,{children:[Object(d.jsx)(l.a,{exact:!0,path:"/",children:Object(d.jsx)(H,{})}),Object(d.jsx)(l.a,{path:"/map",children:Object(d.jsx)(B,{})}),Object(d.jsx)(l.a,{path:"/timeline",children:Object(d.jsx)(Z,{})})]})})]})})}),q=a(131),Q=a(109),X=a(26),Y={clickedCoords:{latitude:0,longitude:0},clickedFeatureId:void 0,sizeChanged:!1,location:{latitude:61.48,longitude:23.79},workplaces:[{location:{latitude:61.5,longitude:23.79},name:"asd",id:"asd"},{location:{latitude:61.4,longitude:23.5},name:"ad",id:"ad"}],zoom:13},$={showJobExpModal:!1,showWorkplaceModal:!1},ee=Object(Q.combineReducers)({map:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_WORKPLACE":return Object(X.a)(Object(X.a)({},e),{},{workplaces:e.workplaces.concat(t.payload)});case"MAP_SIZE_CHANGED":return Object(X.a)(Object(X.a)({},e),{},{sizeChanged:!e.sizeChanged});case"REMOVE_WORKPLACE":return Object(X.a)(Object(X.a)({},e),{},{workplaces:e.workplaces.filter((function(e){return t.payload!==e}))});case"LAST_CLICKED_COORDS":return Object(X.a)(Object(X.a)({},e),{},{clickedCoords:t.payload});case"LAST_CLICKED_FEATURE_ID":return Object(X.a)(Object(X.a)({},e),{},{clickedFeatureId:t.payload});case"SET_LOCATION":return Object(X.a)(Object(X.a)({},e),{},{location:t.payload});case"SET_MAPVIEW":return Object(X.a)(Object(X.a)({},e),{},{location:t.payload.location,zoom:t.payload.zoom});case"SET_WORKPLACES":return Object(X.a)(Object(X.a)({},e),{},{workplaces:t.payload});case"SET_ZOOM":return Object(X.a)(Object(X.a)({},e),{},{zoom:t.payload});default:return e}},modal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_JOB_MODAL":return Object(X.a)(Object(X.a)({},e),{},{showJobExpModal:!e.showJobExpModal,showWorkplaceModal:!1});case"TOGGLE_WORK_MODAL":return Object(X.a)(Object(X.a)({},e),{},{showWorkplaceModal:!e.showWorkplaceModal,showJobExpModal:!1});default:return e}}}),te=Object(Q.createStore)(ee,Object(q.composeWithDevTools)());o.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(i.a,{children:Object(d.jsx)(p.a,{store:te,children:Object(d.jsx)(U,{})})})}),document.getElementById("root"))}},[[191,1,2]]]);
//# sourceMappingURL=main.a428a923.chunk.js.map